















<script>
    async function handleRegistration(event) {
  event.preventDefault();

  const formData = new FormData(event.target);
  const userData = Object.fromEntries(formData.entries());

  try {
    const response = await fetch('/register', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(userData),
    });

    const data = await response.json();

    if (!response.ok) {
      // Handle validation errors
      displayErrors(data.errors);
    } else {
      // Registration successful
      alert(data.message);
    //   window.location.href = "/otpPage" 
    }
  } catch (error) {
    console.error('Registration error:', error);
    alert('An unexpected error occurred. Please try again.');
  }
}

function displayErrors(errors) {
  // Clear previous errors (give "error-message" class name)
  document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

  // Display new errors
  // field names: fullName, email,  password, confirmPassword
  for (const [field, message] of Object.entries(errors)) {
    const errorElement = document.getElementById(`${field}-error`);
    if (errorElement) {
      errorElement.textContent = message;
    }
  }
}

// Attach the handler to form(give this id to form)
document.getElementById('registration-form').addEventListener('submit', handleRegistration);
</script>